var device={isAndroid:-1<navigator.userAgent.toLowerCase().indexOf("android"),isIos:null!=navigator.userAgent.match(/(iPod|iPhone|iPad)/),isChrome:/chrom(e|ium)/.test(navigator.userAgent.toLowerCase())},common={qrcodeUrl:location.href,accountCode:"",channelCode:"",subChannelCode:"",inviteCode:"",getUrlQuery:function(o){var n=new RegExp("(^|&)"+o+"=([^&]*)(&|$)","i"),e=window.location.search.substr(1).match(n);return null!=e?unescape(e[2]):null},getParms:function(){common.accountCode=common.getUrlQuery("accountCode")||"003",common.channelCode=common.getUrlQuery("channelCode")||"01",common.subChannelCode=common.getUrlQuery("subChannelCode")||"official",common.inviteCode=common.getUrlQuery("inviteCode")||""},init:function(){common.getParms()}};$(function(){common.init()});var config={iosUrl:"itms-services://?action=download-manifest&url=",appHost:"http://app.avohwtpgb.com",downHost:"https://dl.mybbcam.com",downloadUrlAndroid:"",downloadUrlIos:"",app_code:"0000",setDownUrl:function(){device.isAndroid?(config.app_code="0022",config.downloadUrlAndroid=config.downHost+"/download/android/"+config.app_code+common.channelCode+"_"+common.subChannelCode+".apk"):device.isIos&&(config.app_code="0021",config.downloadUrlIos=config.iosUrl+config.downHost+"/download/ios/"+common.accountCode+"_"+config.app_code+common.channelCode+"_"+common.subChannelCode+".plist")},init:function(){config.setDownUrl()}};$(function(){config.init()});var objApp={saveInviteCode:function(){$.ajax({url:config.appHost+"/promo/from/website?inviteCode="+common.inviteCode,type:"GET",contentType:"application/json",dataType:"jsonp"})},addClipboard:function(o,n){var e=location.origin+location.pathname+"?inviteCode="+common.inviteCode+"=inviteCode";$("#bar2").val(e);var i=new ClipboardJS(o,{container:document.getElementById(n)});i.on("success",function(o){objApp.saveInviteCode()}),i.on("error",function(o){console.log("浜诧紝姝ゆ祻瑙堝櫒涓嶆敮鎸侊紝璇锋墜鍔ㄥ鍒剁矘璐村惂")})},initClick:function(){$(".download-btn").click(function(){device.isIos||device.isAndroid?(objApp.addClipboard(".download-btn","bar2"),objApp.initSiteUser(2),device.isIos?location.href=config.downloadUrlIos:device.isAndroid&&(location.href=config.downloadUrlAndroid)):$(".dialog-container").removeClass("hide")}),$(".dialog-container").click(function(){$(".dialog-container").addClass("hide")})},mySwipe:function(){window.mySwipe=Swipe(document.getElementById("mySwipe"),{speed:400,auto:3e3,continuous:!0,disableScroll:!1,stopPropagation:!1,callback:function(o,n){},transitionEnd:function(o,n){}})},makeCode:function(){new QRCode(document.getElementById("qrcode"),{width:100,height:100}).makeCode(common.qrcodeUrl)},initSiteUser:function(o){$.ajax({type:"get",url:config.appHost+"/log/officialWebsiteUser",dataType:"json",timeout:3e3,data:{appCode:config.app_code,channelCode:common.channelCode||"",subChannelCode:common.subChannelCode||"guanfang",type:o},success:function(o){console.log("res:",o)},error:function(o){console.log("err:",o&&o.statusText)}})},checkPlatForm:function(){device.isAndroid||device.isIos?($("#bar").focus(function(){document.activeElement.blur()}),device.isIos?(812==screen.availHeight&&375==screen.availWidth&&"375"==window.innerWidth&&"812"==window.innerHeight&&($(".ewm-tk").css("margin","2rem auto 1rem"),$(".bg-text").addClass("bgText")),$(".ios-tips").removeClass("hide"),$(".download-head >.download-btn").html("iOS下载")):device.isAndroid?($(".android-tips").removeClass("hide"),$(".download-head >.download-btn").html("Android下载")):window.prompt("确认下载")):($(".ios-tips").removeClass("hide"),$(".android-tips").removeClass("hide"),$(".download-head >.download-btn").html("点击下载"),$(".a_downcont").css("display","none"),$(".a_ios").find("img").attr("src","images/wap-icon-ios.png"),$(".a_android").find("img").attr("src","images/wap-icon-android.png"),objApp.makeCode())},isType:function(o){switch(o){case"001":$(".ios-tips img").attr("src","images/ios-001.png");break;case"002":$(".ios-tips img").attr("src","images/ios-002.png");break;case"003":$(".ios-tips img").attr("src","images/ios-003.png")}},init:function(){objApp.isType(common.accountCode),objApp.checkPlatForm(),objApp.initSiteUser(1),objApp.mySwipe(),objApp.initClick()}};$(function(){objApp.init()});